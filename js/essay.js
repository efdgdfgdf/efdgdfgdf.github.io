var percentFlag=!1;function essayScroll(){const e=(document.documentElement.scrollTop||window.pageYOffset)%document.documentElement.clientHeight;result<=99||(result=99),!percentFlag&&e+100>=document.documentElement.clientHeight&&document.querySelector("#waterfall")?setTimeout((()=>{waterfall("#waterfall")}),500):setTimeout((()=>{document.querySelector("#waterfall")&&waterfall("#waterfall")}),500);const t=window.scrollY+document.documentElement.clientHeight;let n=document.getElementById("post-comment")||document.getElementById("footer");(n.offsetTop+n.offsetHeight/2<t||90<result)&&(percentFlag=!0)}function replaceAll(e,t,n){return e.split(t).join(n)}var anzhiyu={diffDate:function(e,t=!1){const n=new Date,a=new Date(e),o=n.getTime()-a.getTime(),l=36e5,i=24*l;let c;if(t){const e=o/i,t=o/l,n=o/6e4;c=o/2592e6>=1?a.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else c=parseInt(o/i);return c},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=anzhiyu.diffDate(n,!0),t.style.display="inline"}))},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)},changeTimeInAlbumDetail:function(){document.querySelector("#album_detail")&&document.querySelectorAll("#album_detail time").forEach((function(e){var t=e.getAttribute("datetime");e.innerText=anzhiyu.diffDate(t,!0),e.style.display="inline"}))},addMediumInEssay:function(){document.querySelector("#waterfall")&&mediumZoom(document.querySelectorAll("[data-zoomable]"))},commentText:function(e){"undefined"!=e&&"null"!=e||(e="好棒！");var t=document.getElementsByClassName("el-textarea__inner")[0],n=document.createEvent("HTMLEvents");if(t){n.initEvent("input",!0,!0);var a=replaceAll(e,"\n","\n> ");t.value="> "+a+"\n\n",t.dispatchEvent(n);var o=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,o-80),t.focus(),t.setSelectionRange(-1,-1),document.getElementById("comment-tips")&&document.getElementById("comment-tips").classList.add("show")}}};anzhiyu.changeTimeInEssay(),anzhiyu.changeTimeInAlbumDetail(),anzhiyu.reflashEssayWaterFall(),$(".author-content.author-content-item.single").append('<canvas id="header_canvas" style="position:absolute;bottom:0" width="844" height="346">'),$(".author-content.author-content-item.single").parent().attr("class","thumbnail_canvas"),function(){var e,t,n,a,o,l=!0;if(e=document.getElementById("header_canvas"),u(),e){t=e.getContext("2d"),o=[];for(var i=.04*n,c=0;c<i;c++){var r=new s;o.push(r)}!function e(){if(l)for(var i in t.clearRect(0,0,n,a),o)o[i].draw();requestAnimationFrame(e)}()}function u(){var t=document.querySelector(".thumbnail_canvas");t&&(n=t.offsetWidth,a=t.offsetHeight,e.width=n,e.height=a)}function s(){var e=this;function o(){e.pos.x=Math.random()*n,e.pos.y=a+100*Math.random(),e.alpha=.1+.5*Math.random(),e.alpha_change=2e-4+5e-4*Math.random(),e.scale=.2+.8*Math.random(),e.scale_change=.002*Math.random(),e.speed=.1+.4*Math.random()}e.pos={},o(),this.draw=function(){e.alpha<=0&&o(),e.pos.y-=e.speed,e.alpha-=e.alpha_change,e.scale+=e.scale_change,t.beginPath(),t.arc(e.pos.x,e.pos.y,10*e.scale,0,2*Math.PI,!1),t.fillStyle="rgba(255,255,255,"+e.alpha+")",t.fill()}}window.onresize=function(){u()}}();